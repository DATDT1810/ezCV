[build]
builder = "NIXPACKS" 

[deploy]
numReplicas = 1

# --- API service ---
[[services]]
name = "api"
dockerfilePath = "Dockerfile.api"  # Railway sẽ hiểu

[services.env]
ASPNETCORE_ENVIRONMENT = "Production"

[[services.ports]]
port = 8080
targetPort = 8080

# --- Web service ---
[[services]]
name = "web"
dockerfilePath = "Dockerfile.web"

[services.env]
ASPNETCORE_ENVIRONMENT = "Production"
ApiSettings__BaseUrl = "https://ezcv-api.up.railway.app"

[[services.ports]]
port = 3000
targetPort = 8080